[
    (def persistent-fn (fn (x :int) :int [
        (debug "Persistent function:" x)
        (def r 1)
    ]))
    
    (debug "Calling persistent function")
    (persistent-fn 42)
    
    [
        (def scoped-fn (fn (y :int) :int [
            (debug "Scoped function:" y)
            (def r 2)
        ]))
        
        (debug "Calling scoped function inside scope")
        (scoped-fn 100)
        
        [
            (def deep-scoped-fn (fn (z :int) :int [
                (debug "Deep scoped function:" z)
                (def r 3)
            ]))
            
            (debug "Calling deep scoped function")
            (deep-scoped-fn 200)
        ]
        
        (debug "After deep scope exits")
    ]
    
    (debug "After all inner scopes exit")
    (debug "Persistent function still callable")
    (persistent-fn 99)
]

