[
    #(load "kv" "io")

    (io/put "=== ERROR Type Round-Trip Test ===\n")
    (kv/open-memory store)

    (io/put "\n--- Simple Errors ---\n")
    (kv/set store:err1 @("simple error message"))
    (kv/set store:err2 @("file not found"))
    (kv/set store:err3 @("invalid input"))
    
    (def retrieved1 (kv/get store:err1))
    (def retrieved2 (kv/get store:err2))
    (def retrieved3 (kv/get store:err3))
    
    (io/put "Error 1 stored and retrieved\n")
    (io/put "Error 2 stored and retrieved\n")
    (io/put "Error 3 stored and retrieved\n")

    (io/put "\n--- Error with Numeric Values ---\n")
    (kv/set store:err_num @(404))
    (kv/set store:err_code @(500))
    
    (def retrieved_num (kv/get store:err_num))
    (def retrieved_code (kv/get store:err_code))
    
    (io/put "Numeric error stored and retrieved\n")
    (io/put "Error code stored and retrieved\n")

    (io/put "\n--- Nested Errors ---\n")
    (kv/set store:nested @(error with @(nested error)))
    (def retrieved_nested (kv/get store:nested))
    (io/put "Nested error stored and retrieved\n")

    (io/put "\n--- Errors in Lists ---\n")
    (kv/set store:list '(@("error1") @("error2") @("error3")))
    (def retrieved_list (kv/get store:list))
    (io/put "List of errors stored and retrieved\n")

    (io/put "\n--- Complex Error Structure ---\n")
    (kv/set store:complex @((code 404) (message "not found") (timestamp 12345)))
    (def retrieved_complex (kv/get store:complex))
    (io/put "Complex error structure stored and retrieved\n")

    (io/put "\n=== All error tests complete ===\n")
]

