[
    #(load "forge" "io")

    (io/put "=== Forge Mixed Types Test ===\n")

    (io/put "\n--- Paren lists ---\n")
    (def p0 '(1 2 3))
    (def p1 (forge/pf p0 0))
    (def p2 (forge/rev p0))
    (assert (eq (forge/count p1) 4) "Push front should give 4 elements")
    (def p1_list (cast :list-p p1))
    (assert (eq (at 0 p1_list) 0) "First should be 0")
    (assert (eq (at 1 p1_list) 1) "Second should be 1")
    (assert (eq (forge/count p2) 3) "Reverse should preserve size")
    (def p2_list (cast :list-p p2))
    (assert (eq (at 0 p2_list) 3) "First should be 3")
    (assert (eq (at 2 p2_list) 1) "Last should be 1")
    (io/put "Paren list operations: OK\n")

    (io/put "\n--- Bracket lists ---\n")
    (def b0 '[1 2 3])
    (def b1 (forge/pf b0 0))
    (def b2 (forge/rev b0))
    (assert (eq (forge/count b1) 4) "Push front should give 4 elements")
    (def b1_list (cast :list-p b1))
    (assert (eq (at 0 b1_list) 0) "First should be 0")
    (assert (eq (forge/count b2) 3) "Reverse should preserve size")
    (def b2_list (cast :list-p b2))
    (assert (eq (at 0 b2_list) 3) "First should be 3")
    (io/put "Bracket list operations: OK\n")

    (io/put "\n--- Brace lists ---\n")
    (def br0 '{1 2 3})
    (def br1 (forge/pf br0 0))
    (def br2 (forge/rev br0))
    (assert (eq (forge/count br1) 4) "Push front should give 4 elements")
    (def br1_list (cast :list-p br1))
    (assert (eq (at 0 br1_list) 0) "First should be 0")
    (assert (eq (forge/count br2) 3) "Reverse should preserve size")
    (def br2_list (cast :list-p br2))
    (assert (eq (at 0 br2_list) 3) "First should be 3")
    (io/put "Brace list operations: OK\n")

    (io/put "\n--- String (DQ_LIST) ---\n")
    (def s0 "abc")
    (def s1 (forge/count s0))
    (assert (eq s1 3) "String count should be 3")
    (io/put "String count: %d\n" s1)

    (io/put "\n--- Mixed value types in list ---\n")
    (def m0 '(1 a 3.14 "text"))
    (def m1 (forge/count m0))
    (def m2 (forge/rev m0))
    (def m3 (forge/replace m0 a x))
    (assert (eq m1 4) "Mixed list should have 4 elements")
    (assert (eq (at 0 m0) 1) "First should be 1")
    (assert (eq (at 1 m0) 'a) "Second should be a")
    (assert (eq (forge/count m2) 4) "Reversed mixed should have 4 elements")
    (def m2_list (cast :list-p m2))
    (assert (eq (at 0 m2_list) "text") "First of reversed should be text")
    (assert (eq (forge/count m3) 4) "Replaced mixed should have 4 elements")
    (def m3_list (cast :list-p m3))
    (assert (eq (at 1 m3_list) 'x) "Second should be x")
    (io/put "Mixed value types: count=%d\n" m1)
    (io/put "Reverse mixed types: OK\n")
    (io/put "Replace in mixed types: OK\n")

    (io/put "\n--- Nested lists ---\n")
    (def n0 '(1 (2 3) 4))
    (def n1 (forge/count n0))
    (def n2 (forge/rev n0))
    (assert (eq n1 3) "Nested list should have 3 top-level elements")
    (assert (eq (at 0 n0) 1) "First element should be 1")
    (assert (eq (at 2 n0) 4) "Third element should be 4")
    (assert (eq (forge/count n2) 3) "Reversed nested should have 3 elements")
    (def n2_list (cast :list-p n2))
    (assert (eq (at 0 n2_list) 4) "First of reversed should be 4")
    (assert (eq (at 2 n2_list) 1) "Last of reversed should be 1")
    (io/put "Nested list count: %d\n" n1)
    (io/put "Reverse nested list: OK\n")

    (io/put "\n=== All mixed type tests complete ===\n")
]
