[
    #(load "forge" "io")

    (io/put "=== Forge Resize Test ===\n")

    (io/put "\n--- Growing a list ---\n")
    (def x0 '(1 2 3 4 5))
    (def x1 (forge/resize x0 10 0))
    (assert (eq (forge/count x1) 10) "Resized list should have 10 elements")
    (def x1_list (cast :list-p x1))
    (assert (eq (at 0 x1_list) 1) "First element should be 1")
    (assert (eq (at 4 x1_list) 5) "Fifth element should be 5")
    (assert (eq (at 5 x1_list) 0) "Sixth element should be 0")
    (assert (eq (at 9 x1_list) 0) "Tenth element should be 0")
    (io/put "Resized (1 2 3 4 5) to size 10 with default 0\n")

    (io/put "\n--- Shrinking a list ---\n")
    (def y0 '(1 2 3 4 5 6 7 8 9 10))
    (def y1 (forge/resize y0 3 0))
    (assert (eq (forge/count y1) 3) "Resized list should have 3 elements")
    (def y1_list (cast :list-p y1))
    (assert (eq (at 0 y1_list) 1) "First element should be 1")
    (assert (eq (at 1 y1_list) 2) "Second element should be 2")
    (assert (eq (at 2 y1_list) 3) "Third element should be 3")
    (io/put "Resized (1 2 3 4 5 6 7 8 9 10) to size 3\n")

    (io/put "\n--- Resize to same size ---\n")
    (def z0 '(a b c))
    (def z1 (forge/resize z0 3 x))
    (assert (eq (forge/count z1) 3) "Resized list should have 3 elements")
    (def z1_list (cast :list-p z1))
    (assert (eq (at 0 z1_list) 'a) "First element should be a")
    (assert (eq (at 1 z1_list) 'b) "Second element should be b")
    (assert (eq (at 2 z1_list) 'c) "Third element should be c")
    (io/put "Resized (a b c) to size 3 - no change\n")

    (io/put "\n--- Resize to zero ---\n")
    (def w0 '(1 2 3))
    (def w1 (forge/resize w0 0 0))
    (assert (eq (forge/count w1) 0) "Resized list should be empty")
    (io/put "Resized (1 2 3) to size 0 - empty list\n")

    (io/put "\n--- Resize with non-zero default ---\n")
    (def v0 '(1 2))
    (def v1 (forge/resize v0 5 99))
    (assert (eq (forge/count v1) 5) "Resized list should have 5 elements")
    (def v1_list (cast :list-p v1))
    (assert (eq (at 0 v1_list) 1) "First element should be 1")
    (assert (eq (at 1 v1_list) 2) "Second element should be 2")
    (assert (eq (at 2 v1_list) 99) "Third element should be 99")
    (assert (eq (at 4 v1_list) 99) "Fifth element should be 99")
    (io/put "Resized (1 2) to size 5 with default 99\n")

    (io/put "\n=== All resize tests complete ===\n")
]
