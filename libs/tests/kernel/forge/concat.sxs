[
    #(load "forge" "io")

    (io/put "=== Forge Concat Test ===\n")

    (io/put "\n--- Basic Concat ---\n")
    (def x0 '(1 2 3))
    (def x1 '(4 5 6))
    (def x2 (forge/concat x0 x1))
    (assert (eq (forge/count x2) 6) "Concatenated list should have 6 elements")
    (def x2_list (cast :list-p x2))
    (assert (eq (at 0 x2_list) 1) "First element should be 1")
    (assert (eq (at 3 x2_list) 4) "Fourth element should be 4")
    (assert (eq (at 5 x2_list) 6) "Sixth element should be 6")
    (io/put "Concatenated (1 2 3) and (4 5 6)\n")

    (io/put "\n--- Concat with empty ---\n")
    (def y0 '(1 2))
    (def y1 '())
    (def y2 (forge/concat y0 y1))
    (assert (eq (forge/count y2) 2) "Concat with empty should have 2 elements")
    (assert (eq y2 '(1 2)) "Result should match expected")
    (io/put "Concatenated (1 2) with empty list\n")

    (io/put "\n--- Concat empty with list ---\n")
    (def z0 '())
    (def z1 '(1 2))
    (def z2 (forge/concat z0 z1))
    (assert (eq (forge/count z2) 2) "Concat empty with list should have 2 elements")
    (assert (eq z2 '(1 2)) "Result should match expected")
    (io/put "Concatenated empty list with (1 2)\n")

    (io/put "\n--- Concat scalar and list ---\n")
    (def w0 1)
    (def w1 '(2 3))
    (def w2 (forge/concat w0 w1))
    (assert (eq (forge/count w2) 3) "Concat scalar with list should have 3 elements")
    (assert (eq w2 '(1 2 3)) "Result should match expected")
    (io/put "Concatenated scalar 1 with (2 3)\n")

    (io/put "\n=== All concat tests complete ===\n")
]
